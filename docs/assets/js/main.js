"use strict";const searchButton=document.querySelector(".js-search"),inputSerie=document.querySelector(".js-input"),seriesContainer=document.querySelector(".js-series-container"),seriesFavoriteContainer=document.querySelector(".js-favorites__container"),resetButton=document.querySelector(".js-reset");let series=[],favorites=[];function getFavs(){null!==localStorage.getItem("favorite-serie")&&getInLocalStorage()}function showReset(){favorites!==[]?resetButton.classList.remove("hidden"):resetButton.classList.add("hidden")}function completeUrl(){return"//api.tvmaze.com/search/shows?q="+inputSerie.value.toLowerCase()}function getFromApi(e){let t=completeUrl();fetch(t).then(e=>e.json()).then(e=>{series=e,showSeriesList()}),e.preventDefault()}function showSeriesList(){seriesContainer.innerHTML="";let e="";for(let t of series){let s=t.show.image;s=null===s?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":s.original,e=!0===isFavorite?"favorite-serie":"";let i=t.show.schedule.time;i=""===i?"no available":t.show.schedule.time,seriesContainer.innerHTML+=`<li class="series-container__series js-serie ${e}" id="${t.show.id}"><img class="series-container__series--img" src="${s}"/><h4 class="series-container__series--time"> ${i}</h4><h3 class="series-container__series--name">${t.show.name}</h3></li>`}listenSeries(),listenFavorites(),listenDeleteIcons()}function handleFavorite(e){const t=parseInt(e.currentTarget.id),s=series.find(e=>e.show.id===t),i=favorites.findIndex(e=>e.show.id===t);-1===i?favorites.push(s):favorites.splice(i,1),setInLocalStorage(),showSeriesList(),showSeriesFavorites()}function isFavorite(e){return void 0!==favorites.find(t=>t.show.id===e.show.id)}function resetFavorites(e){favorites=[],showSeriesFavorites(),e.preventDefault(),showSeriesList(),localStorage.clear(),showReset()}function showSeriesFavorites(){listenSeries();let e="";for(let t of favorites){let s=t.show.image;s=null===s?"https://via.placeholder.com/210x295/ffffff/666666/?text=TV":s.original,e+=`<li class="favorites__container--favseries  js-seriefavorite" id="${t.show.id}"><img class="favorites-img"  src="${s}"/><h3 class="favorites-name">${t.show.name}</h3><i class="fas fa-trash-alt js-icon id="${t.show.id}"></i></li>`}seriesFavoriteContainer.innerHTML=e,0===favorites.length?seriesFavoriteContainer.classList.add("hidden"):seriesFavoriteContainer.classList.remove("hidden"),listenFavorites(),listenDeleteIcons(),setInLocalStorage()}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorite-serie",e)}function getInLocalStorage(){favorites=JSON.parse(localStorage.getItem("favorite-serie")),showSeriesFavorites()}function listenSeries(){let e=document.querySelectorAll(".js-serie");for(const t of e)t.addEventListener("click",handleFavorite)}function listenFavorites(){let e=document.querySelectorAll(".js-seriefavorite");for(const t of e)t.addEventListener("click",deleteFavorite)}function deleteFavorite(e){let t=e.currentTarget,s=e.currentTarget.id;const i=favorites.find(e=>e.show.id===s),o=favorites.findIndex(e=>e.show.id===s);-1===o?favorites.splice(o,1):favorites.push(i),t.classList.toggle("hidden"),setInLocalStorage()}function listenDeleteIcons(){let e=document.querySelectorAll(".js-icon");for(const t of e)t.addEventListener("click",deleteFavorite)}getFavs(),showReset(),searchButton.addEventListener("click",getFromApi),resetButton.addEventListener("click",resetFavorites),listenDeleteIcons(),listenFavorites();